<div class="max-w-4xl mx-auto p-6 space-y-10">
  <div>
    <h1 class="text-3xl font-bold text-gray-800">Meilleure Copro Test</h1>
    <h2 class="text-xl text-gray-600 mt-2">Les charges de copropriétés</h2>
  </div>

  <!-- Formulaire stats -->
  <form (ngSubmit)="submit()" class="bg-[#25c38b] p-6 rounded-lg shadow space-y-4">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Rechercher par:</label>
      <select
        [(ngModel)]="filterType"
        name="filterType"
        class="w-full border rounded px-3 py-2 focus:ring focus:ring-blue-200"
      >
        <option value="department">Département</option>
        <option value="city">Ville</option>
        <option value="postal_code">Code Postal</option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Valeur:</label>
      <input
        [(ngModel)]="filterValue"
        name="filterValue"
        required
        class="w-full border rounded px-3 py-2 focus:ring focus:ring-blue-200"
      />
    </div>

    <button type="submit" class="bg-[#ea9010] text-white px-4 py-2 rounded hover:text-black transition">
      Afficher les statistiques
    </button>
  </form>

  <!-- Résultats -->
  <div *ngIf="result" class="bg-[#25c38b] p-6 rounded-lg shadow">
    <h3 class="text-lg font-semibold mb-4">Resultats</h3>

    <table class="w-full text-sm border border-gray-200 bg-white">
    <tbody class="divide-y divide-gray-200">
        <tr class="odd:bg-white even:bg-gray-200">
          <th class="text-left p-2">Nombre d'annonces avec charges de copro</th>
          <td class="p-2">{{ result.count }}</td>
        </tr>
        <tr class="odd:bg-white even:bg-gray-200">
          <th class="text-left p-2">Charges moyennes</th>
          <td class="p-2">{{ result.average }} €</td>
        </tr>
        <tr class="odd:bg-white even:bg-gray-200">
          <th class="text-left p-2">Charges quantile 10% </th>
          <td class="p-2">{{ result.quantile_10 }} €</td>
        </tr>
        <tr class="odd:bg-white even:bg-gray-200">
          <th class="text-left p-2">Charges quantile 90%</th>
          <td class="p-2">{{ result.quantile_90 }} €</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Erreur -->
  <div *ngIf="error" class="text-red-600 font-medium">
    {{ error }}
  </div>

  <hr class="border-gray-300">

  <!-- Ajout annonce -->
  <div class="bg-[#25c38b] p-6 rounded-lg shadow space-y-4">
    <h2 class="text-xl font-semibold">Ajouter une annonce Bienici</h2>
    <form (ngSubmit)="addAd()" class="flex flex-col sm:flex-row gap-4">
      <input
        [(ngModel)]="adUrl"
        name="adUrl"
        required
        placeholder="Collez l'URL Bienici ici"
        class="flex-1 border rounded px-3 py-2 focus:ring focus:ring-blue-200"
      />
      <button type="submit" class="bg-[#ea9010] text-white px-4 py-2 rounded hover:text-black transition">
        Ajouter
      </button>
    </form>

    <div *ngIf="addAdResult">
      <div *ngIf="addAdResult.success" class="text-white space-y-1">
        <p class="font-semibold">Annonce ajoutée avec succès !</p>
        <p>ID: {{ addAdResult.data.bienici_id }}</p>
        <p>Ville: {{ addAdResult.data.city }}</p>
        <p>Département: {{ addAdResult.data.department }}</p>
        <p>Code postal: {{ addAdResult.data.postal_code }}</p>
        <p>Charges: {{ addAdResult.data.condo_fees }} €</p>
      </div>

      <div *ngIf="!addAdResult.success" class="text-red-600">
        Erreur: {{ addAdResult.message }}
      </div>
    </div>
  </div>
</div>
